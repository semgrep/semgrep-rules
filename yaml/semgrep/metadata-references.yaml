rules:
- id: metadata-references
  message: >-
    The references in rule metadata should always be a list, even if there's only one.
  severity: ERROR
  languages: [json, yaml]
  patterns:
  - pattern-inside: |
      rules: ...
  - pattern-inside: |
      metadata: ...
        owasp:
        - A00: 0000
  - pattern: |
      references: ...
  - pattern-not: |
      references: [...]
  metadata:
    owasp:
    - A00: 0000
    category: correctness
    technology:
    - semgrep
