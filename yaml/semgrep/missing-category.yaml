rules:
- id: missing-category
  message: >-
    This Semgrep rule '$...ID' is missing a valid 'category' field in the 'metadata'.
    'category' must be one of 'security', 'correctness', 'best-practice',
    'performance', 'maintainability', or 'portability'.
  severity: INFO
  patterns:
  - pattern: |
      - id: ...
        ...
  - pattern-not-inside: |
      - id: ...
        ...
        metadata:
          ...
          category: $CATEGORY
  languages: [yaml]
