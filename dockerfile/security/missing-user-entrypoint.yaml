rules:
- id: missing-user-entrypoint
  patterns:
    - pattern: |
        ENTRYPOINT $...VARS
    - pattern-not-inside: |
        USER $USER
        ...
  fix: |
    USER non-root
    ENTRYPOINT $...VARS
  message: The absence of an ENTRYPOINT in a Dockerfile poses security risks. Without ENTRYPOINT, a program within the container may inadvertently execute with elevated privileges, running as the root user. This creates vulnerabilities as an attacker gaining control over a process running as root can potentially compromise the entire container.. 
  severity: ERROR
  languages: 
    - dockerfile
  metadata:
    cwe:
    - 'CWE-269: Improper Privilege Management'
    category: security
    technology:
    - dockerfile
    confidence: MEDIUM
    owasp:
    - A04:2021 - Insecure Design
    references:
    - https://owasp.org/Top10/A04_2021-Insecure_Design
    subcategory:
    - audit
    likelihood: LOW
    impact: MEDIUM
