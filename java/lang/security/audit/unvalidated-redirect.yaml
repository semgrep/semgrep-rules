rules:
- id: unvalidated-redirect
  message: |
    https://find-sec-bugs.github.io/bugs.htm#UNVALIDATED_REDIRECT
    Application redirects a user to a destination URL specified by a user supplied parameter that is not validated.
  severity: WARNING
  languages: [java]
  pattern-either:
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...,String $URL,...) {
          ...
          $RES.sendRedirect($URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,String $URL,...,HttpServletResponse $RES,...) {
          ...
          $RES.sendRedirect($URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {
          ...
          String $URL = $REQ.getParameter(...);
          ...
          $RES.sendRedirect($URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {
          ...
          String $URL = $REQ.getParameter(...);
          ...
          $RES.sendRedirect($URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,String $URL,...) {
          ...
          HttpServletResponse $RES = ...;
          ...
          $RES.sendRedirect($URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {
          ...
          $RES.sendRedirect($REQ.getParameter(...));
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {
          ...
          $RES.sendRedirect($REQ.getParameter(...));
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...,String $URL,...) {
          ...
          $RES.addHeader("Location",$URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,String $URL,...,HttpServletResponse $RES,...) {
          ...
          $RES.addHeader("Location",$URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {
          ...
          String $URL = $REQ.getParameter(...);
          ...
          $RES.addHeader("Location",$URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {
          ...
          String $URL = $REQ.getParameter(...);
          ...
          $RES.addHeader("Location",$URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,String $URL,...) {
          ...
          HttpServletResponse $RES = ...;
          ...
          $RES.addHeader("Location",$URL);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {
          ...
          $RES.addHeader("Location",$REQ.getParameter(...));
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {
          ...
          $RES.addHeader("Location",$REQ.getParameter(...));
          ...
        }