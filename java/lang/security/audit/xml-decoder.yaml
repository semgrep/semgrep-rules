rules:
- id: xml-decoder
  message: |
    https://find-sec-bugs.github.io/bugs.htm#XML_DECODER
    XMLDecoder should not be used to parse untrusted data. Deserializing user input can lead to arbitrary code execution.
  severity: WARNING
  languages: [java]
  patterns:
    - pattern: |
        $X $METHOD(...) {
          ...
          new XMLDecoder(...);
          ...
        }
    - pattern-not: |
        $X $METHOD(...) {
          ...
          new XMLDecoder("...");
          ...
        }
    - pattern-not: |
        $X $METHOD(...) {
          ...
          String $STR = "...";
          ...
          new XMLDecoder($STR);
          ...
        }