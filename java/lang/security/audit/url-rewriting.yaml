rules:
- id: url-rewriting
  message: |
    https://find-sec-bugs.github.io/bugs.htm#URL_REWRITING
    URL rewriting has significant security risks.
    Since session ID appears in the URL, it may be easily seen by third parties.
  severity: WARNING
  languages: [java]
  pattern-either:
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...) {
          ...
          $RES.encodeURL(...);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...) {
          ...
          $RES.encodeUrl(...);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...) {
          ...
          $RES.encodeRedirectURL(...);
          ...
        }
    - pattern: |
        $X $METHOD(...,HttpServletResponse $RES,...) {
          ...
          $RES.encodeRedirectUrl(...);
          ...
        }
    - pattern: |
        $X $METHOD(...) {
          ...
          HttpServletResponse $RES = ...;
          ...
          $RES.encodeURL(...);
          ...
        }
    - pattern: |
        $X $METHOD(...) {
          ...
          HttpServletResponse $RES = ...;
          ...
          $RES.encodeUrl(...);
          ...
        }
    - pattern: |
        $X $METHOD(...) {
          ...
          HttpServletResponse $RES = ...;
          ...
          $RES.encodeRedirectURL(...);
          ...
        }
    - pattern: |
        $X $METHOD(...) {
          ...
          HttpServletResponse $RES = ...;
          ...
          $RES.encodeRedirectUrl(...);
          ...
        }