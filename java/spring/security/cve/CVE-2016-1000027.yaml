rules:
- id: java-deserialization-exporter
  message : >
    Pivotal's Spring Framework suffer from a potential remote code execution (RCE) issue via Java HTTPInvokerService.
  patterns :
    - pattern-inside : import org.springframework
    - pattern-either :
      - pattern : |              
            $EXPORTER = new HttpInvokerServiceExporter(...);
      - pattern: |
            $EXPORTER = new SimpleHttpInvokerServiceExporter(...);
      - pattern : |
            $EXPORTER = new RemoteInvocationSerializingExporter(...);
  languages: [java, kotlin]
  severity: ERROR
  metadata:
    category: security
    cwe:
    - "CWE-502: Deserialization of Untrusted Data"
    technology:
    - spring
    references:
    - https://jira.spring.io/browse/SPR-17143
    owasp:
    - A8:2017-Insecure Deserialization
    cwe2022-top25: true
    subcategory:
    - audit
    likelihood: LOW
    impact: HIGH
    confidence: LOW
