rules:
- id: file-inclusion
  patterns:
  - pattern: $FUNC(...);
  - pattern-not: $FUNC("...");
  - pattern-not: $FUNC(__DIR__ . "...");
  - metavariable-regex:
      metavariable: $FUNC
      regex: include|include_once|require|require_once
  message: >-
    Non-constant file inclusion. This can lead to LFI or RFI if user
    input reaches this statement.
  metadata:
    owasp:
    - AA03:2017:2017 - Sensitive Data Exposure
    references:
    - https://www.php.net/manual/en/function.include.php
    - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/EasyRFISniff.php
    - https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Types_of_Inclusion
    category: security
    technology:
    - php
  languages: [php]
  severity: ERROR
