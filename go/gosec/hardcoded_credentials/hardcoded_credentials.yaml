rules:
  - id: hardcoded-credentials
    message: Potential hardcoded credentials
    severity: WARNING
    languages: [go]
    patterns:
      # len([cred_name == vars['$VALUE'] for cred_name in ['"secret"', 'passwd','pass','password','pwd', 'secret', 'token']]) > 1
      - pattern-either: 
          - pattern: $VAR = "..."
          - pattern: $VAR := "..."
          - pattern: var $VAR = "..."
          - pattern: const $VAR = "..."
      - pattern-where-python: |
            "password" in vars['$VAR'].lower() or "passwd" in vars['$VAR'].lower() or\
            "pass" in  vars['$VAR'].lower() or "pwd" in vars['$VAR'].lower()  or \
            "secret" in vars['$VAR'].lower() or "token" in vars['$VAR'].lower()