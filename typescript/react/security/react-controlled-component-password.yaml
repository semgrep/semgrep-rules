rules:
- id: react-controlled-component-password
  pattern-either:
  - pattern: <$EL type="password" value={this.state.$X} onChange=...  />
  - pattern: |
      React.createElement($EL,{type: 'password', value: this.state.$X, onChange:...},...)
  - pattern: |
      $PARAMS = {type: 'password', value: this.state.$X, onChange:...};
      ...
      React.createElement($EL,$PARAMS,...);
  message: >-
    Password can be leaked if CSS injection exists on the page.
  metadata:
    owasp:
    - A1:2017-Injection
    - A3:2017-Sensitive Data Exposure
    category: security
    technology:
    - react
  languages:
  - typescript
  - javascript
  severity: WARNING
