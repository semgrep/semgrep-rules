rules:
- id: use-timeout
  patterns:
  - pattern-not: requests.Session(...)
  - pattern-not: requests.session(...)
  - pattern-not: requests.append(...)
  - pattern-not: requests.$W(..., timeout=$N, ...)
  - pattern: requests.$W(...)
  message: |
    'requests' calls default to waiting until the connection is closed.
    This means a 'requests' call without a timeout will hang the program
    if a response is never received. Consider setting a timeout for all 
    'requests'.
  languages: [python]
  severity: ERROR
