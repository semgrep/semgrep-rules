rules:
  - id: default-mutable-list
    patterns:
      - pattern-either:
        - patterns:
          - pattern: |
              def $F(..., $D=[], ...):
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = []
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = [...]
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = list(...)
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = copy.deepcopy($D)
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = copy.copy($D)
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = list.copy($D)
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = $D[:]
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = [... for ... in ...]
                ...
                $D.append(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = $D or []
                ...
                $D.append(...)
          - pattern-not-inside: |
              def $A(...):
                ...
                def $F(..., $D=[], ...):
                  ...
                  $D.append(...)
        - patterns:
          - pattern: |
              def $F(..., $D=[], ...):
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = []
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = [...]
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = list(...)
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = copy.deepcopy($D)
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = copy.copy($D)
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = list.copy($D)
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = $D[:]
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = [... for ... in ...]
                ...
                $D.extend(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = $D or []
                ...
                $D.extend(...)
          - pattern-not-inside: |
              def $A(...):
                ...
                def $F(..., $D=[], ...):
                  ...
                  $D.extend(...)
        - patterns:
          - pattern: |
              def $F(..., $D=[], ...):
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = []
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = [...]
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = list(...)
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = copy.deepcopy($D)
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = copy.copy($D)
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = list.copy($D)
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = $D[:]
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = [... for ... in ...]
                ...
                $D.insert(...)
          - pattern-not: |
              def $F(..., $D=[], ...):
                ...
                $D = $D or []
                ...
                $D.insert(...)
          - pattern-not-inside: |
              def $A(...):
                ...
                def $F(..., $D=[], ...):
                  ...
                  $D.insert(...)
    message: "Function $F mutates default list $D"
    languages: [python]
    severity: ERROR
