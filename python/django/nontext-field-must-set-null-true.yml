rules:
  - id: nontext-field-must-set-null-true
    patterns:
      - pattern-inside: |
          class $M(...):
            ...
      - pattern-not: $F = $D.CharField(...)
      - pattern-not: $F = CharField(...)
      - pattern-not: $F = $D.TextField(...)
      - pattern-not: $F = TextField(...)
      - pattern-not: $F = $D.SlugField(...)
      - pattern-not: $F = SlugField(...)
      - pattern-not: $F = $D.EmailField(...)
      - pattern-not: $F = EmailField(...)
      - pattern-not: $F = $D.UUIDField(...)
      - pattern-not: $F = UUIDField(...)
      - pattern-not: $F = $X(..., null=True, blank=True, ...)
      - pattern: $F = $X(..., blank=True, ...)
    message: "null=True should be set if blank=True is set on non-text fields."
    languages: [python]
    severity: ERROR
        

