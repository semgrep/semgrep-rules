rules:
  - id: use-count-method
    patterns:
      - pattern-either:
        - pattern: $X.objects.$FUNC(...).len()
        - pattern: $X.objects.$FUNC(...).$FILTER().len()
        - pattern: $X.objects.$FUNC(...).$FILTER().$UPDATE(...).len()
    message: "Looks like you need to determine the number of records. Django provides efficient `count()` method for precisely this reason. See https://docs.djangoproject.com/en/3.0/ref/models/querysets/"
    languages: [python]
    severity: ERROR
