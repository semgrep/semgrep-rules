# https://flask.palletsprojects.com/en/1.1.x/security/#set-cookie-options
rules:
  - id: secure-session-cookies
    patterns:
      - pattern-not: |
          $APP = flask.Flask(...)
          ...
          $APP.config.update(
            ...,
            SESSION_COOKIE_SECURE=True,
            SESSION_COOKIE_HTTPONLY=True,
            SESSION_COOKIE_SAMESITE="...",
            ...
          )
      - pattern: |
          $APP = flask.Flask(...)
          ...
#        - patterns:
#          - pattern-not: |
#              $APP = flask.Flask(...)
#              ...
#              $APP.config["SESSION_COOKIE_SECURE"] = True
#          - pattern-not: |
#              $APP = flask.Flask(...)
#              ...
#              $APP.config["SESSION_COOKIE_HTTPONLY"] = True
#          - pattern-not: |
#              $APP = flask.Flask(...)
#              ...
#              $APP.config["SESSION_COOKIE_SAMESITE"] = "..."
#          - pattern: |
#              $APP = flask.Flask(...)
#              ...
    message: "Session cookies insecure"
    languages: [python]
    severity: WARNING
  - id: secure-set-cookie
    patterns:
      - pattern-not: flask.response.set_cookie(..., secure=True, httponly=True, samesite="...", ...)
      - pattern: flask.response.set_cookie(...)
    message: "Set cookie insecure"
    languages: [python]
    severity: WARNING
