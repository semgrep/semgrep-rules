rules:
  - id: avoid-accessing-request-in-wrong-handler
    patterns:
      - pattern-either:
        - pattern: |
            @app.route(..., method="GET")
            def $X(...):
              $Y = flask.request.json
              ...
              return
        - pattern: |
            @app.route(..., method="GET")
            def $X(...):
              $Y = flask.request.form
              ...
              return
        - pattern: |
            @app.route(..., method="GET")
            def $X(...):
              $Y = flask.request.data
              ...
              return
        - pattern: |
            @app.route(..., methods=["GET", ...])
            def $X(...):
              $Y = flask.request.json
              ...
              return
        - pattern: |
            @app.route(..., methods=["GET", ...])
            def $X(...):
              $Y = flask.request.form
              ...
              return
        - pattern: |
            @app.route(..., methods=["GET", ...])
            def $X(...):
              $Y = flask.request.data
              ...
              return
    message: "Accessing request object inside a route handle for HTTP GET command will throw due to missing request body."
    languages: [python]
    severity: WARNING