rules:
- id: js-open-redirect
  languages:
  - javascript
  - typescript
  message: "Possible open redirect\n"
  metadata:
    cwe: 'CWE-601: URL Redirection to Untrusted Site (Open Redirect)'
    owasp: 'A1: Injection'
  patterns:
  - pattern-either:
    - pattern: "window.location.replace($URL)\n"
    - pattern: "location.replace($URL)\n"
    - pattern: "window.location.href = $URL\n"
    - pattern: "location.href = $URL\n"
  - pattern-not: "window.location.href = \"...\"\n"
  - pattern-not: "location.href = \"...\"\n"
  - pattern-not: "location.replace(\"...\")\n"
  - pattern-not: window.location.replace("...")
  severity: WARNING
