rules:
- fix: ''
  id: insufficient-postmessage-origin-validation
  languages:
  - javascript
  - typescript
  message: "No validation of origin is done by the addEventListener API. It may be possible to exploit this flaw to perform\
    \ Cross Origin attacks such as Cross-Site Scripting(XSS).\n"
  metadata:
    cwe: 'CWE-345: Insufficient Verification of Data Authenticity'
    owasp: 'A6: Sensitive Data Exposure'
  patterns:
  - pattern-either:
    - pattern: "window.addEventListener(...)\n"
  - pattern-not: "window.addEventListener(..., function($OBJECT){ if ($OBJ.origin == $X) {\n            ...\n        } });\n"
  - pattern-not: "window.addEventListener(..., function($OBJECT){ if ($REGEX.test($OBJECT.origin)){\n    ...\n} });\n"
  - pattern-not: "window.addEventListener(..., function($OBJECT){ if ($OBJ.origin !== $X) {\n            ...\n        } });\n"
  severity: WARNING
