rules:
- id: node-forge-open-redirect
  patterns:
    - pattern: $FORGE.util.parseUrl(...)
    - pattern-inside: |
        var $FORGE = require('node-forge')
        ...
    - pattern-not-inside: $FORGE.util.parseUrl("...")
    - r2c-internal-project-depends-on:
      - namespace: npm
        package: node-forge
        version: "< 1.0.0"
  metadata:
    owasp:
      - "A09:2017 - Vulnerable and Outdated Components"
      - "A06:2021 - Vulnerable and Outdated Components"
      - "A05:2017 - Broken Access Control"
      - "A01:2021 - Broken Access Control"
    cwe: "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
    source-rule-url: https://github.com/advisories/GHSA-8fr3-hfg3-gpgp
    category: security
    technology:
      - node
  message: >-
    The "parseUrl" function in versions < 1.0.0 of the "node-forge" library is vulnerable to Open Redirect attacks. (CVE-2022-0211) Please upgrade "node-windows" to version 1.0.0 or later.
  languages: [js]
  severity: WARNING

