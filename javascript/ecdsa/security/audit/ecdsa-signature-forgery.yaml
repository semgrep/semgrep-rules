rules:
  - id: ecdsa-signature-forgery
    patterns:
      - pattern-either:
          - pattern-inside: |
              var $EC = require('starkbank-ecdsa')
              ...
          - pattern-inside: |
              var $ECDSA = $EC.Ecdsa
              ...
      - pattern: $ECDSA.verify(...)
      - r2c-internal-project-depends-on:
          - namespace: npm
            package: starkbank-ecdsa
            version: "< 1.1.3"
    metadata:
      owasp:
        - "A09:2017 - Vulnerable and Outdated Components"
        - "A06:2021 - Vulnerable and Outdated Components"
        - "A03:2017 - Sensitive Data Exposure"
        - "A02:2021 - Cryptographic Failures"
      cwe: "CWE-347: Improper Verification of Cryptographic Signature"
      source-rule-url: https://github.com/advisories/GHSA-9wx7-jrvc-28mm
      category: security
      technology:
        - javascript
    message: |
      Versions < 1.1.3 of the "starkbank-ecdsa" library have a vulnerability in the "verify" function that allows attackers to forge signatures for arbitrary messages. (CVE-2021-43571) Please upgrade "starkbank-ecdsa" to version 1.1.3 or later.
    languages: [javascript]
    severity: WARNING
