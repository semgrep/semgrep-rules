rules:
- id: grpc-nodejs-client-insecure-connection
  message: |
    Found an insecure gRPC connection. This creates a connection without encryption to a gRPC server. A malicious attacker
    could tamper with the gRPC message, which could compromise the machine.
  metadata:
    owasp: 'A8: Insecure Deserialization'
    cwe: 'CWE-502: Deserialization of Untrusted Data'
  severity: ERROR
  languages: [javascript]
  pattern-either:
  - pattern: |
      require('grpc');
      ...
      $CLIENT($ADDR,...,$GRPC.credentials.createInsecure(),...);
  - pattern: |
      require('grpc');
      ...
      $CLIENT($ADDR,...,$CREDENTIALS.createInsecure(),...);
  - pattern: |
      require('grpc');
      ...
      $CREDS = <... $GRPC.credentials.createInsecure() ...>;
      ...
      $CLIENT($ADDR,...,$CREDS,...);
  - pattern: |-
      require('grpc');
      ...
      $CREDS = <... $CREDENTIALS.createInsecure() ...>;
      ...
      $CLIENT($ADDR,...,$CREDS,...);
