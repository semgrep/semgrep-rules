rules:
- id: detect-no-csrf-before-method-override
  languages:
  - javascript
  - typescript
  message: "Detected use of express.csrf() middleware before express.methodOverride(). This can\nallow GET requests (which\
    \ are not checked by csrf) to turn into POST requests later.\n"
  metadata:
    cwe: 'CWE-352: Cross-Site Request Forgery (CSRF)'
    references:
    - https://github.com/nodesecurity/eslint-plugin-security/blob/master/docs/bypass-connect-csrf-protection-by-abusing.md
    source-rule-url: https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-no-csrf-before-method-override.js
  pattern: "express.csrf();\n...\nexpress.methodOverride();\n"
  severity: WARNING
