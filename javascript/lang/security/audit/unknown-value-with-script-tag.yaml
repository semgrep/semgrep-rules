rules:
- id: unknown-value-with-script-tag
  languages:
  - javascript
  - typescript
  message: "Cannot determine what '$UNK' is and it is used with a '<script>' tag. This\ncould be susceptible to cross-site\
    \ scripting (XSS). Ensure '$UNK' is not\nexternally controlled, or sanitize this data.\n"
  metadata:
    cwe: "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
    owasp: 'A7: Cross-site Scripting (XSS)'
    references:
    - https://www.developsec.com/2017/11/09/xss-in-a-script-tag/
    - https://github.com/bkimminich/juice-shop/blob/master/routes/videoHandler.js#L64
  patterns:
  - pattern-inside: "$UNK = $ANYFUNC(...);\n...\n$OTHERFUNC(..., <... $UNK ...>, ...);\n"
  - pattern: $OTHERFUNC(..., <... "=~/.*<script.*/" ...>, ...)
  severity: WARNING
